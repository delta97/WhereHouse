which(distm(c(user[selected_id,]$longitude, user[selected_id,]$latitude), c(warehouse$longitude , warehouse$latitude), fun = distHaversine) *  0.000621371 < 200)
View(distance_calc)
View(distance_calc)
mapply(distance_calc, warehouse$longitude, warehouse$latitude)
View(distance_calc)
View(distance_calc)
calc_dist <- function(lon,lat){
distm(c(user[selected_id,]$longitude, user[selected_id,]$latitude), c(lon , lat), fun = distHaversine) * 0.000621371
}
mapply(distance_calc, warehouse$longitude, warehouse$latitude)
calc_dist <- function(lon,lat){
distance <- distm(c(user[selected_id,]$longitude, user[selected_id,]$latitude), c(lon , lat), fun = distHaversine)    distance <- distance * 0.000621371
calc_dist <- function(lon,lat){
distance <- distm(c(user[selected_id,]$longitude, user[selected_id,]$latitude), c(lon , lat), fun = distHaversine)    distance <- distance * 0.000621371
calc_dist <- function(lon,lat){
distm(c(user[selected_id,]$longitude, user[selected_id,]$latitude), c(lon , lat), fun = distHaversine)
}
distance <- mapply(distance_calc, warehouse$longitude, warehouse$latitude)
distance <- distance * 0.000621371
warehouses <- warehouse[which(distance < 200)]
warehouses <- warehouse[which(distance < 200),]
View(warehouses)
selected_id <- sample(nrow(lessee), 1, 1)
selected_user <- user[selected_id, ]
distance <- mapply(distance_calc, warehouse$longitude, warehouse$latitude)
distance <- distance * 0.000621371
warehouses <- warehouse[which(distance < 200),]
warehouses <- warehouse[which(warehouse$temp == lessee_pref),]
warehouses <- which(distnce < 200)
warehouses <- which(distance < 200)
warehouses <- warehouse[which(distance < 200),]
View(warehouses)
Street <- lapply(paste0("https://www.loopnet.com/warehouses-for-lease/", 1:20,sep="/"),
function(url){
url %>% read_html() %>%
html_nodes(".listingTitle") %>%
html_text() %>%
str_trim() %>%
gsub('-* Warehouse for Lease', '', .)
})
Street <- lapply(paste0("https://www.loopnet.com/warehouses-for-lease/", 1:20,sep="/"),
function(url){
url %>% read_html() %>%
html_nodes(".listingTitle") %>%
html_text() %>%
str_trim() %>%
gsub('-* Warehouse for Lease', '', .)
})
Street <- unlist(Street)
Street <- as.data.frame(Street)
#City and State
city_state <- lapply(paste0('https://www.loopnet.com/warehouses-for-lease/', 1:20,sep="/"),
function(url){
url %>% read_html() %>%
html_nodes(".listingDescription b") %>%
html_text() %>%
str_trim()
})
city_state <- unlist(city_state)
city_state <- as.data.frame(city_state)
city_state <- city_state %>% separate(city_state, sep = "," ,c("city","State"))
#Attributes
df1 <- lapply(paste0('https://www.loopnet.com/warehouses-for-lease/', 1:20,sep="/"),
function(url){
url %>% read_html() %>%
html_nodes(".listingAttributes tr") %>%
html_text() %>%
str_trim()
})
df1 <- unlist(df1)
df1 <- as.data.frame(df1)
#Price per skid per month
price <- df1 %>% filter(str_detect(df1,"Price:")) %>%
separate(df1, sep = ":", c("Text","Fee")) %>%
separate(Fee, sep = "-", c("Fee", "Max"))
price$Text <- NULL
price$Max <- NULL
#Price per skid per month
price <- df1 %>% filter(str_detect(df1,"Price:")) %>%
separate(df1, sep = ":", c("Text","Fee")) %>%
separate(Fee, sep = "-", c("Fee", "Max"))
View(price)
price$Text <- NULL
price$Max <- NULL
price$Fee <- gsub("[^0-9\\.]", "", price$Fee)
price <- as.numeric(price$Fee)
price <- as.data.frame(price)
View(price)
#Building Size
building_size <- df1 %>% filter(str_detect(df1, "Building Size")) %>%
separate(df1, sep = ":", c("Text", "Size"))
building_size$Text <- NULL
building_size$Size <- gsub("[^0-9\\]", "", building_size$Size)
Size <- as.numeric(building_size$Size)
Size <- as.data.frame(Size)
#Warehouse data frame
warehouse <- data.frame(Street,city_state,price, Size)
warehouse <- as.data.frame(warehouse) %>%
mutate(price = price * 12) %>%
mutate(price, replace(price, price > 30, NA)) %>%
na.omit
warehouse$`replace(price, price > 20, NA)` <- NULL
View(warehouse)
warehouse$`replace(price, price > 30, NA)` <- NULL
View(warehouse)
write.csv(warehouse,'zipcode_data.csv')
warehouse <- left_join(warehouse,zipcode, by = "City" & "State")
warehouse <- left_join(warehouse,zipcode, by = "City")
View(zipcode)
View(warehouse)
warehouse <- left_join(warehouse,zipcode, by = "city")
View(warehouse)
#Warehouse data frame
warehouse <- data.frame(Street,city_state,price, Size)
warehouse <- as.data.frame(warehouse) %>%
mutate(price = price * 12) %>%
mutate(price, replace(price, price > 30, NA)) %>%
na.omit
warehouse$`replace(price, price > 30, NA)` <- NULL
View(warehouse)
rm(gen_lessee)
rm(distance_calc())
rm(distance_calc)
rm(get_last_page)
rm(x)
rm(states)
rm(selected_id)
rm(sample_size)
rm(specific)
rm(owner_id)
rm(lessee_pref)
rm(lesse_num)
rm(lat_long)
rm(last_page)
rm(j)
rm(i)
rm(f)
rm(full_name)
rm(expiration_year)
rm(expiration_month)
rm(capacity)
rm(distance)
View(a)
rm(all_cons)
rm(con)
rm(credit_card_num)
rm(CVC)
rm(df)
rm(DOB)
rm(Email)
rm(expiration)
rm(lessee)
rm(names)
rm(password)
rm(Phone_num)
rm(selected_user)
rm(user)
rm(user_type)
View(sam)
rm(sam)
View(subset_1)
rm(subset_1)
rm(warehouses)
View(zipcodes)
rm(zipcodes)
rm(filter_1)
View(warehouse)
warehouse <- tibble::rowid_to_column(warehouse, "ID")
warehouse <- warehouse %>% na.omit
warehouse$temp <- sample(temp, nrow(warehouse), replace = TRUE, prob = c(.30,.50,.15,.05))
#Capacity
capacity <- floor(capacity_find(warehouse$Size))
View(capacity_find)
warehouse$capacity <- capacity
View(warehouse)
warehouse$lowest_temp[warehouse$temp == "frozen"] <- 0
warehouse$lowest_temp[warehouse$temp == "cooler"] <- 34
warehouse$lowest_temp[warehouse$temp == "temp_controlled"] <- 55
warehouse$lowest_temp[warehouse$temp == "dry"] <- 75
warehouse$highest_temp <- 75
warehouse$Price_per_skid <- warehouse$price *16 / 365
warehouse$Adress_2 <- 0
View(warehouse)
head(warehouse)
owner <- company_names
colnames(owner)[1] <- "Company_name"
a <- bind_cols(bank_account,routing_number)
owner$bank_acc <- a$bank_account
owner$routing_num <- a$routing_number
View(owner)
specific <- sample(1:1000,3)
owner <- owner[sample(nrow(owner),399),]
sample_size <- lesse_num + nrow(owner)
lesse_num <- nrow(owner) * 100
credit_card_num <- r_credit_card_numbers(lesse_num)
credit_card_num <- gsub("-","", credit_card_num)
credit_card_num <- as.data.frame(credit_card_num)
expiration_month <- sample(1:12,lesse_num, replace = TRUE)
expiration_year <- sample(2018:2050, lesse_num, replace = TRUE)
expiration <- data.frame(expiration_month, expiration_year)
CVC <- sample(100:999, lesse_num, replace = TRUE)
CVC <- as.data.frame(CVC)
sample_size <- lesse_num + nrow(owner)
full_name <- r_full_names(sample_size)
df <- as.data.frame(full_name)
names <- tidyr::separate(df, full_name, sep = " ", c("First_name", "Last_name" ))
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#User type
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
user_type <- as.data.frame(rbinom(sample_size, 1, nrow(owner)/ sample_size))
sum(user_type) - length(user_type)
#Phone Number
Phone_num <- r_phone_numbers(sample_size)
#Phone Number
Phone_num <- r_phone_numbers(sample_size)
Phone_num <- as.data.frame(Phone_num)
Email <- r_email_addresses(sample_size)
Email <- as.data.frame(Email)
DOB <- sample(seq(as.Date('1950/01/01'), as.Date('2000/01/01'), by="day"), sample_size, replace = TRUE )
DOB <- as.data.frame(DOB)
data(zipcode)
View(zipcode)
install.packages("zipcode")
install.packages("generator")
install.packages("RMySQL")
install.packages("random")
install.packages("tidyr")
install.packages("sampling")
install.packages("ggmap")
install.packages("rvest")
install.packages("RMySQL")
install.packages("httr")
install.packages("XML")
install.packages("stringi")
install.packages("tidyverse")
install.packages("geosphere")
library(tidyverse)
library(generator)
library(zipcode)
library(tidyr)
library(dplyr)
library(sampling)
library(ggmap)
library(rvest)
library(stringr)
library(ggplot2)
library(stringi)
library(RMySQL)
library(geosphere)
con <- dbConnect(MySQL(),
user="g1090429", password="WhereHouse?",
dbname="g1090429", host="mydb.ics.purdue.edu")
on.exit(dbDisconnect(con))
View(owner)
owner_id <- user[sample(nrow(user), 399), 1]
#Password
password<- stri_rand_strings(n=sample_size, length=15, pattern="[A-Za-z0-9]")
password <- as.data.frame(password)
a <- data.frame(DOB,Phone_num, user_type, Email, password)
user <- names
user$First_name <- as.character(names$First_name)
user$Last_name <- as.character(names$Last_name)
user$DOB <- a$DOB
user$Phone_num <- a$Phone_num
user$Email <- as.character(a$Email)
user$Password <- as.character(a$password)
user <- user[, -c(1:2)]
user <- tibble::rowid_to_column(user, "id")
View(user)
user$First_name <- as.character(names$First_name)
user$Last_name <- as.character(names$Last_name)
View(user)
owner_id <- user[sample(nrow(user), 399), 1]
lessee_id <- user[-owner_id,1]
credit_card_num <- r_credit_card_numbers(lesse_num)
credit_card_num <- gsub("-","", credit_card_num)
credit_card_num <- as.data.frame(credit_card_num)
expiration_month <- sample(1:12,lesse_num, replace = TRUE)
expiration_year <- sample(2018:2050, lesse_num, replace = TRUE)
expiration <- data.frame(expiration_month, expiration_year)
CVC <- sample(100:999, lesse_num, replace = TRUE)
CVC <- as.data.frame(CVC)
lessee_id <- as.data.frame(lessee_id)
lessee <- bind_cols(lessee_id,credit_card_num,expiration, CVC)
View(lessee)
lessee_id <- user[-owner_id,1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
owner_id <- user[sample(nrow(user), 399), 1]
lessee_id <- user[-owner_id,1]
lessee_id <- as.data.frame(lessee_id)
lessee <- bind_cols(lessee_id,credit_card_num,expiration, CVC)
View(lessee)
cvc <- sample(100:999, lesse_num, replace = TRUE)
cvc <- as.data.frame(CVC)
lessee <- bind_cols(lessee_id,credit_card_num,expiration, CVC)
View(lessee)
#Zipcodes
zipcodes <- read.csv("test.csv") %>% select("Zipcode", "ID")
#Zipcodes
zipcodes <- read.csv("test.csv") %>% select("zipcode", "ID")
#Zipcodes
zipcodes <- read.csv("test.csv") %>% select("zipcode", "ID")
warehouse <- left_join(warehouse,zipcode, by = "ID")
warehouse <- tibble::rowid_to_column(warehouse, "ID")
warehouse <- left_join(warehouse,zipcode, by = "ID")
warehouse <- left_join(warehouse, zipcodes, by = "ID")
View(warehouse)
warehouse <- left_join(warehouse, zipcodes, by = "ID")
View(warehouse)
warehouse <- NULL
#Warehouse data frame
warehouse <- data.frame(Street,city_state,price, Size)
warehouse <- as.data.frame(warehouse) %>%
mutate(price = price * 12) %>%
mutate(price, replace(price, price > 30, NA)) %>%
na.omit
warehouse$`replace(price, price > 30, NA)` <- NULL
View(warehouse)
View(warehouse)
warehouse <- left_join(warehouse, zipcodes, by = "Street")
View(warehouse)
#Zipcodes
zipcodes <- read.csv("test.csv") %>% select("zipcode", "ID", "Street")
warehouse <- left_join(warehouse, zipcodes, by = "Street")
warehouse <- with(warehouse,  warehouse[order(City) , ])
View(warehouse)
warehouse <- NULL
#Warehouse data frame
warehouse <- data.frame(Street,city_state,price, Size)
warehouse <- as.data.frame(warehouse) %>%
mutate(price = price * 12) %>%
mutate(price, replace(price, price > 30, NA)) %>%
na.omit
warehouse$`replace(price, price > 30, NA)` <- NULL
View(warehouse)
sort.warehouse <- with(warehouse,  warehouse[order(street) , ])
sort.warehouse <- with(warehouse,  warehouse[order(Street) , ])
View(warehouse)
warehouse <- left_join(warehouse, zipcodes, by = "City")
warehouse <- left_join(warehouse, zipcodes, by = "city")
sort.warehouse <- with(warehouse,  warehouse[order(city) , ])
View(warehouse)
warehouse <- warehouse %>% arrange(warehouse, desc(city))
warehouse <- warehouse %>% arrange()
View(warehouse)
warehouse <- warehouse %>% arrange(city)
View(warehouse)
View(warehouse)
warehouse <- left_join(warehouse, zipcodes, by = "city")
warehouse <- tibble::rowid_to_column(warehouse, "ID")
warehouse <- left_join(warehouse, zipcodes, by = "ID")
View(warehouse)
warehouse$Street.y <- NULL
View(warehouse)
warehouse$temp <- sample(temp, nrow(warehouse), replace = TRUE, prob = c(.30,.50,.15,.05))
warehouse$capacity <- capacity
warehouse$lowest_temp[warehouse$temp == "frozen"] <- 0
warehouse$lowest_temp[warehouse$temp == "cooler"] <- 34
warehouse$lowest_temp[warehouse$temp == "temp_controlled"] <- 55
warehouse$lowest_temp[warehouse$temp == "dry"] <- 75
warehouse$highest_temp <- 75
warehouse$Price_per_skid <- warehouse$price *16 / 365
warehouse$Adress_2 <- 0
View(warehouse)
warehouse$adress_2 <- 0
warehouse$adress_1 <- warehouse$Street.x
warehouse <- warehouse[c(1,15,14,3,4,7,6,9,12,8,10,11)]
View(warehouse)
colnames(warehouse) <- c("warehouse_id", "address_1", "address_2", "city", "state", "zipcode", "size", "capacity", "price_per_skid", "storage_pref", "lowest_temp", "highest_temp" )
View(warehouse)
dbWriteTable(con, "Warehouse", warehouse, overwrite = TRUE)
con <- dbConnect(MySQL(),
user="g1090429", password="WhereHouse?",
dbname="g1090429", host="mydb.ics.purdue.edu")
dbWriteTable(con, "Warehouse", warehouse, overwrite = TRUE)
#Address
data <- read.csv("address.csv")
address_2 <- 0
user <- names
user$First_name <- as.character(names$First_name)
user$Last_name <- as.character(names$Last_name)
user <- names
user <- names
user$first_name <- as.character(names$First_name)
user$last_name <- as.character(names$Last_name)
user$address_1 <- as.character(data$Street.Address)
data <- sample(nrow(data),nrow(user))
user$address_1 <- as.character(data$Street.Address)
data <- as.data.frame(data)
user$address_1 <- as.character(data$Street.Address)
#Address
data <- read.csv("address.csv")
data <- sample(nrow(data),nrow(user))
data <- as.data.frame(data)
user <- names
user$first_name <- as.character(names$First_name)
user$last_name <- as.character(names$Last_name)
user$address_1 <- as.character(data$Street.Address)
View(data)
data <- sample(nrow(data),nrow(user),)
data <- as.data.frame(data)
View(data)
#Address
data <- read.csv("address.csv")
data <- sample(nrow(data),nrow(user),)
#Address
data <- read.csv("address.csv")
#Address
data <- read.csv("address.csv")
user$address_1 <- data$Street.Address)
user$address_1 <- data$Street.Address
user$address_2 <- address_2
user$city <- as.character(data$City)
user$state <- as.character(data$State)
user$zipcode <- as.integer(data$Zip.Code)
user$dob <- a$DOB
user$phone_num <- a$Phone_num
user$email <- as.character(a$Email)
user$password <- as.character(a$password)
View(user)
user <- user[, -c(1:2)]
user <- tibble::rowid_to_column(user, "id")
dbWriteTable(con, "User", user, overwrite = TRUE)
user1 <- left_join(user, zipcode, by= "zipcode")
View(owner)
owner_id <- user[sample(nrow(user), 399), 1]
owner$owner_id <- owner_id
owner <- owner[c(4,1,2,3)]
dbWriteTable(con, "Owner", owner, overwrite = TRUE)
View(lessee)
dbWriteTable(con, "Lessee", lessee, overwrite = TRUE)
View(owner)
